<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Alan R. Vazquez">
  <title>TEC-IN2004B – Classification Methods</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-2f366650f320edcfcf53d73c80250a32.css">
  <link rel="stylesheet" href="style.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Classification Methods</h1>
  <p class="subtitle">IN2004B: Generation of Value with Data Analytics</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Alan R. Vazquez 
</div>
        <p class="quarto-title-affiliation">
            Department of Industrial Engineering
          </p>
    </div>
</div>

</section>
<section id="agenda" class="slide level2">
<h2>Agenda</h2>
<p><br></p>
<ol type="1">
<li>Introducción</li>
<li>Classification and Regression Trees (CART)</li>
<li>Métricas de Algoritmos de Clasificación</li>
<li><em>K</em> vecinos cercanos</li>
</ol>
</section>
<section>
<section id="introducción" class="title-slide slide level1 center">
<h1>Introducción</h1>

</section>
<section id="load-the-libraries" class="slide level2">
<h2>Load the libraries</h2>
<p>Before we start, let’s import the data science libraries into Python.</p>
<div id="fd9bcc84" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="co"># Importing necessary libraries</span></span>
<span id="cb1-2"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay, accuracy_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we will introduce the functions <code>confusion_matrix()</code>, <code>ConfusionMatrixDisplay()</code> and <code>accuracy_score()</code> to evaluate the performance of a logistic regression classifier.</p>
</section>
<section id="problemas-principales-de-cienca-de-datos" class="slide level2">
<h2>Problemas principales de cienca de datos</h2>
<p><span style="color:green;"><strong>Problemas de regresión</strong></span>. La respuesta es numérica. Por ejemplo, los ingresos de una persona, el valor de una casa, la presión arterial del paciente.</p>
<p><span style="color:blue;"><strong>Problemas de clasificación</strong></span>. La respuesta es categórica e involucra K categorías diferentes. Por ejemplo, la marca de un producto adquirido (A, B, C) o si una persona incumple una deuda (sí o no).</p>
<p>Los predictores pueden ser numéricos o categóricos.</p>
</section>
<section id="section" class="slide level2">
<h2></h2>
<p><br></p>
<p><span style="text-decoration: underline;">Respuesta</span>:</p>
<div>
<ul>
<li class="fragment"><p><span class="math inline">\(Y\)</span> es una <span style="color:darkgreen;"><strong>variable categórica</strong></span> que toma <span style="color:darkgreen;"><strong>2 categorías</strong></span> o <span style="color:darkgreen;"><strong>clases</strong></span>.</p></li>
<li class="fragment"><p>Por ejemplo, <span class="math inline">\(Y\)</span> puede tomar <span style="color:darkgreen;">0</span> o <span style="color:darkgreen;">1</span>, <span style="color:darkgreen;">A</span> o <span style="color:darkgreen;">B</span>, <span style="color:darkgreen;">no</span> o <span style="color:darkgreen;">sí</span>, <span style="color:darkgreen;">spam</span> o <span style="color:darkgreen;">no spam</span>.</p></li>
</ul>
<p>Cuando las clases son cadenas, se suele codificarlas como 0 y 1.</p>
<p>La <strong>clase de destino</strong> es aquella para la que <span class="math inline">\(Y = 1\)</span>. La <strong>clase de referencia</strong> es aquella para la que <span class="math inline">\(Y = 0\)</span>.</p>
</div>
</section>
<section id="algoritmos-de-clasificación" class="slide level2">
<h2>Algoritmos de Clasificación</h2>
<p>Los algoritmos de clasificación usan los valores de los predictores <span style="color:lightblue;">para predecir la clase</span> de la respuesta (objetivo o referencia).</p>
<p>Es decir, para un registro no visto, usan los valores de los predictores para predecir si el registro pertenece a la clase objetivo o no.</p>
<p>Técnicamente, predicen la <span style="color:purple;">probabilidad</span> de que el registro pertenece a la clase objetivo.</p>
</section>
<section id="ejemplo-1" class="slide level2">
<h2>Ejemplo 1</h2>
<p>Considere un filtro de correo no deseado donde <span class="math inline">\(Y\)</span> es el tipo de correo.</p>
<ul>
<li>La clase de destino es spam. En este caso, <span class="math inline">\(Y=1\)</span>.</li>
<li>La clase de referencia no es spam. En este caso, <span class="math inline">\(Y=0\)</span>.</li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/spam.png" class="quarto-figure quarto-figure-center" width="556" height="178"></p>
</figure>
</div>
</div>
<div class="fragment">
<p>Ambos correos se clasificarían como spam. Sin embargo, tendríamos mayor confianza en nuestra clasificación para el segundo correo.</p>
</div>
</section></section>
<section>
<section id="classification-and-regression-trees-cart" class="title-slide slide level1 center">
<h1>Classification and Regression Trees (CART)</h1>

</section>
<section id="arbol-de-decisión" class="slide level2">
<h2>Arbol de Decisión</h2>
<p>Es un algoritmo de aprendizaje supervisado que predice o clasifica observaciones usando una estructura de arbol jerarquica.</p>
<ul>
<li><p>Sencillo y útil para interpretaciones.</p></li>
<li><p>Puede manejar predictores y respuestas numéricas y categóricas.</p></li>
<li><p>Computacionalmente eficiente.</p></li>
<li><p>Técnica no paramétrica.</p></li>
</ul>
</section>
<section id="ejemplo-2-identificar-billetes-falsos" class="slide level2">
<h2>Ejemplo 2: Identificar Billetes Falsos</h2>
<p><br></p>

<img data-src="images/clipboard-270396609.png" class="r-stretch"><p>Conjunto de datos</p>
<p>Los datos se encuentran en el archivo “banknotes.xlsx”.</p>
<div id="b7efa4ab" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>bank_data <span class="op">=</span> pd.read_excel(<span class="st">"banknotes.xlsx"</span>)</span>
<span id="cb2-2"><a></a><span class="co"># Set response variable as categorical.</span></span>
<span id="cb2-3"><a></a>bank_data[<span class="st">'Status'</span>] <span class="op">=</span> pd.Categorical(bank_data[<span class="st">'Status'</span>])</span>
<span id="cb2-4"><a></a>bank_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Status</th>
<th data-quarto-table-cell-role="th">Left</th>
<th data-quarto-table-cell-role="th">Right</th>
<th data-quarto-table-cell-role="th">Bottom</th>
<th data-quarto-table-cell-role="th">Top</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>genuine</td>
<td>131.0</td>
<td>131.1</td>
<td>9.0</td>
<td>9.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>genuine</td>
<td>129.7</td>
<td>129.7</td>
<td>8.1</td>
<td>9.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>genuine</td>
<td>129.7</td>
<td>129.7</td>
<td>8.7</td>
<td>9.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>genuine</td>
<td>129.7</td>
<td>129.6</td>
<td>7.5</td>
<td>10.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>genuine</td>
<td>129.6</td>
<td>129.7</td>
<td>10.4</td>
<td>7.7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Generar datos de entrenamiento</p>
<p>Dividimos el conjunto de datos actual en dos conjuntos de datos: de entrenamiento y de validación. Para ello, utilizamos la función <code>train_test_split()</code> de <strong>scikit-learn</strong>.</p>
<div id="003de047" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="co"># Set full matrix of predictors.</span></span>
<span id="cb3-2"><a></a>X_full <span class="op">=</span> bank_data.drop(columns <span class="op">=</span> [<span class="st">'Status'</span>])</span>
<span id="cb3-3"><a></a></span>
<span id="cb3-4"><a></a><span class="co"># Set full matrix of responses.</span></span>
<span id="cb3-5"><a></a>Y_full <span class="op">=</span> bank_data[<span class="st">'Status'</span>]</span>
<span id="cb3-6"><a></a></span>
<span id="cb3-7"><a></a><span class="co"># Split the dataset.</span></span>
<span id="cb3-8"><a></a>X_train, X_val, Y_train, Y_val <span class="op">=</span> train_test_split(X_full, Y_full, </span>
<span id="cb3-9"><a></a>                                                    test_size<span class="op">=</span><span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El parámetro <code>test_size</code> establece la parte del conjunto de datos que irá al conjunto de validación.</p>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<p><br></p>
<ul>
<li><p>La función realiza una partición inteligente de los datos utilizando la distribución <em>empírica</em> de la respuesta.</p></li>
<li><p>Técnicamente, divide los datos para que la distribución de la respuesta en los conjuntos de entrenamiento y validación sea similar.</p></li>
<li><p>Normalmente, la proporción del conjunto de datos que se destina al conjunto de prueba es del 20 % o 30 %.</p></li>
<li><p>Más adelante, utilizaremos el <span style="color:orange;"><strong>conjunto de datos de validación</strong></span> para evaluar el rendimiento de clasificación del modelo de regresión logística estimado para clasificar datos no observados.</p></li>
</ul>
</section>
<section id="idea-básica-de-un-árbol-de-decisión" class="slide level2">
<h2>Idea básica de un árbol de decisión</h2>
<p>Estratificar o segmentar el espacio predictor en varias regiones más simples.</p>

<img data-src="images/Screenshot 2025-07-28 at 11.47.35 a.m..png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-2" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.012.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-3" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.013.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="cómo-se-construye-un-árbol-de-decisión" class="slide level2">
<h2>¿Cómo se construye un árbol de decisión?</h2>
<p>La construcción de árboles de decisión implica dos procedimientos principales.</p>
<ol type="1">
<li><p><span style="color:lightblue;">Crece un árbol grande.</span></p></li>
<li><p><span style="color:lightblue;">Poda el árbol para evitar un ajuste excesivo.</span></p></li>
</ol>
<p>Después de construir un “buen” árbol, podemos predecir nuevas observaciones que no se encuentran en el conjunto de datos que usamos para construirlo.</p>
</section>
<section id="cómo-crecemos-un-arbol" class="slide level2">
<h2>¿Cómo crecemos un arbol?</h2>
<p><strong>Usando el algoritmo CART!</strong></p>
<p>El algoritmo utiliza una estrategia de división binaria recursiva que construye el árbol utilizando un enfoque codicioso de arriba hacia abajo.</p>
<p>Básicamente, en un nodo determinado, considera todas las variables y todas las posibles divisiones de esa variable. Luego, para la clasificación, elige la mejor variable y la divide que <strong>minimiza</strong> la llamada <span style="color:purple;"><strong><em>impureza</em></strong></span>.</p>
</section>
<section id="section-4" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.016.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-5" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.017.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-6" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.018.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-7" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.019.jpeg" class="r-stretch"></section>
<section id="section-8" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.020.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-9" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.021.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-10" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.022.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-11" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.023.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-12" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.024.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-13" class="slide level2">
<h2></h2>
<div class="center">
<div class="columns">
<div class="column" style="width:40%;">
<p>Repetimos el proceso de partición hasta que los nodos terminales tengan no menos de 5 observaciones</p>
</div><div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/Modulo 2 - Algoritmos de Clasificacion.025.jpeg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</div>
</section>
<section id="qué-es-impureza" class="slide level2">
<h2>¿Qué es impureza?</h2>
<p>La impureza del nodo se refiere a la homogeneidad de las clases de respuesta en ese nodo.</p>
<div class="center">
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/Impurity1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/Impurity2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</div>
<p><span style="color:darkgray;"><em>El algorítmo CART minimiza la impureza entre los nodos del arbol.</em></span></p>
</section></section>
<section>
<section id="cómo-medimos-la-impureza" class="title-slide slide level1 center">
<h1>¿Cómo medimos la impureza?</h1>
<div class="center">
<div class="columns">
<div class="column" style="width:40%;">
<p>Hay tres métricas diferentes para la impureza:</p>
<ul>
<li><p>Riesgo de clasificación errónea</p></li>
<li><p>Entropía cruzada</p></li>
<li><p>Índice de impurezas de Gini</p></li>
</ul>
</div><div class="column" style="width:60%;">
<p><img data-src="images/Metrics1.png" class="quarto-figure quarto-figure-center"> <img data-src="images/Metrics2.png" class="quarto-figure quarto-figure-center"> <span class="smallcaps">Proportion of elements in a class</span></p>
</div></div>
</div>
</section>
<section id="podando-el-arbol" class="slide level2">
<h2>Podando el Arbol</h2>
<p>Para evitar un ajuste excesivo, podamos algunas de las ramas del árbol. Más específicamente, colapsamos dos nodos internos (no terminales).</p>

<img data-src="images/clipboard-1949573140.png" class="r-stretch"></section>
<section id="section-14" class="slide level2">
<h2></h2>

<img data-src="images/Modulo 2 - Algoritmos de Clasificacion.029.jpeg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-15" class="slide level2">
<h2></h2>
<p>Para podar un arbol usamos un algoritmo avanzado para medir la contribucón de las ramas del arbol.</p>
<p>El algoritmo tiene un parametro de ajuste llamado <span class="math inline">\(\alpha\)</span>, que <strong>pone mayor peso en el numero de nodos del arbol</strong> (o tamaño):</p>
<ul>
<li><p>Valores grandes de <span class="math inline">\(\alpha\)</span> resultan en arboles pequeños con pocos nodos.</p></li>
<li><p>Valores pequeños de <span class="math inline">\(\alpha\)</span> resultan en arboles grandes con muchos nodos.</p></li>
</ul>
</section>
<section id="detalles-de-implementación" class="slide level2">
<h2>Detalles de implementación</h2>
<ul>
<li><p>Predictores categóricos con niveles desordenados <span class="math inline">\(\{A, B, C\}\)</span>. Ordenamos los niveles de una manera específica (funciona para problemas binarios y de regresión).</p></li>
<li><p>Predictores con valores faltantes. Para predictores cuantitativos, usamos imputación múltiple. Para predictores categóricos, creamos un nuevo nivel “NA”.</p></li>
<li><p>Divisiones terciarias o cuartarias. No hay mucha mejora.</p></li>
<li><p>Divisiones en diagonal (usando una combinación lineal para la partición). Pueden conducir a una mejora, pero perjudican la interpretabilidad.</p></li>
</ul>
</section></section>
<section>
<section id="ejemplo-en-python" class="title-slide slide level1 center">
<h1>Ejemplo en Python</h1>
<p>Los datos “AdultReduced.jmp” provienen del Repositorio de Aprendizaje Automático de la UCI y se derivan de registros del censo de USA.</p>
<p>En estos datos, el objetivo es predecir si los ingresos de una persona eran grandes (definidos en 1994 como más de 50.000 dólares) o pequeños.</p>
<p>Los predictores incluyen nivel educativo, tipo de trabajo (por ejemplo, nunca trabajó y gobierno local), ganancias/pérdidas de capital, horas de trabajo por semana, país de origen, etc.</p>
<p>Los datos tienen 7,508 registros.</p>
</section>
<section id="desventaja-de-los-arboles-de-decisión" class="slide level2">
<h2>Desventaja de los Arboles de Decisión</h2>
<ul>
<li><p>Los árboles de decisión tienen una gran variación. Un pequeño cambio en los datos de entrenamiento puede dar lugar a un árbol muy diferente.</p></li>
<li><p>Tiene problemas para identificar estructuras de datos simples.</p></li>
</ul>

<img data-src="images/clipboard-3265772983.png" class="r-stretch"></section></section>
<section>
<section id="métricas-de-algoritmos-de-clasificación" class="title-slide slide level1 center">
<h1>Métricas de Algoritmos de Clasificación</h1>

</section>
<section id="evaluación" class="slide level2">
<h2>Evaluación</h2>
<p><br></p>
<p>Evaluamos un clasificador de regresión logística clasificando las observaciones que no se utilizaron para el entrenamiento ni para su estimación.</p>
<p>Es decir, utilizamos el clasificador para predecir las categorías del conjunto de datos de prueba utilizando únicamente los valores predictores de este conjunto.</p>
<p>En Python, usamos los comandos:</p>
<div id="f1bf97fb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="co"># Remove problematic predictor from the test set.</span></span>
<span id="cb4-2"><a></a><span class="co">#X_val = X_val.drop(columns = ['Right'])</span></span>
<span id="cb4-3"><a></a></span>
<span id="cb4-4"><a></a><span class="co"># Add constant to the predictor matrix from the test set.</span></span>
<span id="cb4-5"><a></a><span class="co">#X_val = sm.add_constant(X_val)</span></span>
<span id="cb4-6"><a></a></span>
<span id="cb4-7"><a></a><span class="co"># Predict probabilities.</span></span>
<span id="cb4-8"><a></a><span class="co">#predicted_probability = logit_model.predict(X_val)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-16" class="slide level2">
<h2></h2>
<p>La función <code>predict()</code> genera <span style="color:brown;"><strong>probabilidades</strong></span> en lugar de las clases reales.</p>
<div id="fdbc51f0" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="co">#predicted_probability.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estas son las probabilidades de que un billete sea “falso” según sus características (valores de los predictores).</p>
<p>Para convertir las probabilidades en clases reales, las redondeamos:</p>
<div id="a54b875d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="co">#predicted_classes = round(predicted_probability).astype('int')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-17" class="slide level2">
<h2></h2>
<div id="aa31d7fd" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="co">#predicted_classes.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Las observaciones con probabilidades superiores a 0,5 se clasifican como “falsas”.</li>
<li>Las observaciones con probabilidades inferiores a 0,5 se clasifican como “genuinas”.</li>
</ul>
<p>Ahora, comparamos las predicciones con las categorías reales en el <span style="color:orange;"><strong>conjunto de datos de validación</strong></span>. <span style="color:darkblue;">Un buen modelo de regresión logística presenta una buena concordancia entre sus predicciones y las categorías reales.</span></p>
</section>
<section id="matriz-de-confusión" class="slide level2">
<h2>Matriz de confusión</h2>
<ul>
<li><p>Tabla utilizada para evaluar el rendimiento de un clasificador.</p></li>
<li><p>Compara los valores reales con los valores predichos de un clasificador.</p></li>
<li><p>Útil para problemas de clasificación binaria y multiclase.</p></li>
</ul>

<img data-src="images/confusion_matrix.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="en-python" class="slide level2">
<h2>En Python</h2>
<p><br></p>
<p>Calculamos la matriz de confusión utilizando la función homónima <strong>scikit-learn</strong>.</p>
<div id="8db3c86c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="co"># Create dummy variables for test set.</span></span>
<span id="cb8-2"><a></a><span class="co">#Y_dummies = pd.get_dummies(Y_val, dtype = 'int')</span></span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a><span class="co"># Select target variable from test set.</span></span>
<span id="cb8-5"><a></a><span class="co">#Y_target_test = Y_dummies['counterfeit']</span></span>
<span id="cb8-6"><a></a></span>
<span id="cb8-7"><a></a><span class="co"># Compute confusion matrix.</span></span>
<span id="cb8-8"><a></a><span class="co">#cm = confusion_matrix(Y_target_test, predicted_classes)</span></span>
<span id="cb8-9"><a></a></span>
<span id="cb8-10"><a></a><span class="co"># Show confusion matrix.</span></span>
<span id="cb8-11"><a></a><span class="co">#print(cm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-18" class="slide level2">
<h2></h2>
<p>Podemos visualizar la matriz de confusión utilizando la función <code>ConfusionMatrixDisplay()</code>.</p>
<div id="faae0cca" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a><span class="co">#ConfusionMatrixDisplay(cm).plot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="precisión" class="slide level2">
<h2>Precisión</h2>
<p>Una métrica simple para resumir la información de la matriz de confusión es la <strong>precisión</strong>. Es la proporción de clasificaciones correctas para ambas clases, del total de clasificaciones realizadas.</p>
<p>En Python, calculamos la precisión mediante la función <code>accuracy_score()</code> de <strong>scikit-learn</strong>.</p>
<div id="f650c38c" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="co">#accuracy = accuracy_score(Y_target_test, predicted_classes)</span></span>
<span id="cb10-2"><a></a><span class="co">#print( round(accuracy, 2) )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>Cuanto mayor sea la precisión, mejor será el rendimiento del clasificador.</p>
</section>
<section id="observaciones" class="slide level2">
<h2>Observaciones</h2>
<p><br></p>
<ul>
<li><p>La precisión es fácil de calcular e interpretar.</p></li>
<li><p>Funciona bien cuando el conjunto de datos tiene una distribución de clases equilibrada (es decir, casos 1 y 0 aproximadamente iguales).</p></li>
<li><p>Sin embargo, hay situaciones en las que identificar la clase objetivo es más importante que la clase de referencia.</p></li>
<li><p>Por ejemplo, no es ideal para conjuntos de datos desequilibrados. Cuando una clase es mucho más frecuente que la otra, la precisión puede ser engañosa.</p></li>
</ul>
</section>
<section id="un-ejemplo" class="slide level2">
<h2>Un ejemplo</h2>
<ul>
<li><p>Digamos que deseamos crear un clasificador que nos diga si un cliente de una empresa de telefonía móvil abandonará el próximo mes.</p></li>
<li><p>Los clientes que abandonan disminuyen significativamente los ingresos de la empresa. Por eso es importante conservar a estos clientes.</p></li>
<li><p>Para retener a ese cliente, la empresa le enviará un mensaje de texto con una oferta para un plan móvil de bajo costo.</p></li>
<li><p>Idealmente, nuestro clasificador identifica correctamente a los clientes que abandonarán, para que obtengan la oferta y, con suerte, se queden.</p></li>
</ul>
</section>
<section id="section-19" class="slide level2">
<h2></h2>
<ul>
<li><p>En otras palabras, queremos evitar tomar decisiones equivocadas sobre clientes que abandonarán.</p></li>
<li><p>Las decisiones equivocadas sobre los clientes leales no son tan relevantes.</p></li>
<li><p>Porque si clasificamos a un cliente leal como uno que abandonará, el cliente obtendrá una buena oferta. Probablemente pagará menos pero se quedará de todos modos.</p></li>
</ul>
</section>
<section id="otro-ejemplo" class="slide level2">
<h2>Otro ejemplo</h2>
<ul>
<li><p>Otro ejemplo es desarrollar un algoritmo (clasificador) que pueda identificar rápidamente a pacientes que puedan tener una enfermedad rara y necesiten una evaluación médica más exhaustiva y costosa.</p></li>
<li><p>El clasificador debe tomar decisiones correctas sobre los pacientes con la enfermedad rara, para que sean evaluados y eventualmente tratados.</p></li>
<li><p>Un paciente sano al que se clasifica erróneamente con la enfermedad sólo incurrirá en algunos dólares extra para pagar el siguiente estudio. Sólo para descubrir que el paciente no tiene la enfermedad.</p></li>
</ul>
</section>
<section id="métricas-especificas-de-clasificación" class="slide level2">
<h2>Métricas especificas de clasificación</h2>
<p>Para superar esta limitación de exactitud y tasa de error, existen varias métricas específicas de clase. Los más populares son:</p>
<ul>
<li><p><span style="color:darkblue;"><strong>Sensibilidad</strong></span> o <em>recall</em></p></li>
<li><p><span style="color:darkgreen;"><strong>Presición</strong></span></p></li>
<li><p><strong>Error tipo I</strong></p></li>
</ul>
<p>Estas métricas se calculan de la matriz de confusión.</p>
</section>
<section id="section-20" class="slide level2">
<h2></h2>

<img data-src="images/classspecific_metrics.png" class="quarto-figure quarto-figure-center r-stretch"><p><span style="color:darkblue;"><strong>Sensibilidad</strong></span> o <em>recall</em> = OO/(OO + OR) “¿Cuántos registros de la clase objetivo predijimos correctamente?”</p>
</section>
<section id="section-21" class="slide level2">
<h2></h2>

<img data-src="images/classspecific_metrics.png" class="quarto-figure quarto-figure-center r-stretch"><p><span style="color:darkgreen;"><strong>Presición</strong></span> = OO/(OO + RO) ¿Cuántos de los registros que predijimos como de clase objetivo fueron clasificados correctamente?</p>
</section>
<section id="section-22" class="slide level2">
<h2></h2>

<img data-src="images/classspecific_metrics.png" class="quarto-figure quarto-figure-center r-stretch"><p><strong>Error tipo I</strong> = RO/(RO + RR) “¿Cuántos de los registros de referencia predijimos incorrectamente como de objetivo?”</p>
</section>
<section id="discusión" class="slide level2">
<h2>Discusión</h2>
<ul>
<li><p>Generalmente existe un compromiso entre sensibilidad y error de tipo I.</p></li>
<li><p>Intuitivamente, aumentar la sensibilidad de un clasificador probablemente genere un aumento del error tipo I, porque se predicen más observaciones como positivas.</p></li>
<li><p>Las posibles compensaciones entre sensibilidad y error de tipo I pueden ser apropiadas cuando existen diferentes sanciones o costos asociados con cada tipo de error.</p></li>
</ul>
</section>
<section id="ejemplo" class="slide level2">
<h2>Ejemplo</h2>
<p>Asumiendo que la clase de interés o objetivo es “large”</p>
<ul>
<li><p>Sensibilidad = 566/(566 + 214) = 0.726</p></li>
<li><p>Precisión = 566/(566 + 156) = 0.783</p></li>
<li><p>Error Tipo 1 = 156/(156+655) = 0.192</p></li>
</ul>
</section>
<section id="actividad-2.1-clasificación-y-métricas-cooperative-mode" class="slide level2">
<h2>Actividad 2.1: Clasificación y métricas (cooperative mode)</h2>
<p>Juntate con un compañero.</p>
<p>Utilizando los datos de la tabla “weight-height.csv” aplica el procedimiento CART para construir un árbol de decisión útil para predecir el sexo de una persona a partir de su peso y su estatura.</p>
<p>En este ejemplo las variables predictoras son continuas y la variable a predecir es binaria.</p>
</section>
<section id="section-23" class="slide level2">
<h2></h2>
<p>Interpreta los valores de Precision, Exactitud, Sensibilidad y Error Tipo 1 para el conjunto de validación. Si el software no los reporta haz los cálculos a partir de la matriz de confusión. Utiliza “Female” como clase objetivo.</p>
<p>Discute sobre la efectividad del modelo resultante.</p>
</section></section>
<section>
<section id="k-vecinos-cercanos" class="title-slide slide level1 center">
<h1><em>K</em> vecinos cercanos</h1>
<p>Es un algoritmo de aprendizaje supervisado que usa la proximidad para hacer clasificaciones o predicciones sobre la agrupación de un punto de datos individual.</p>
<p><strong>Idea básica</strong>: predecir una nueva observación utilizando las K observaciones más cercanas en el conjunto de datos de entrenamiento.</p>
<p>Para predecir la respuesta de una nueva observación, K-NN utiliza los K vecinos (observaciones) más cercanos en <span style="color:aqua;"><strong><em>terminos de los predictores!</em></strong></span></p>
<p>La respuesta prevista para la nueva observación es la respuesta más común de los K vecinos.</p>
</section>
<section id="el-algoritmo-tiene-3-pasos" class="slide level2">
<h2>El algoritmo tiene 3 pasos</h2>
<ol type="1">
<li><p>Elige el numero de vecinos más cercanos (K).</p></li>
<li><p>Para una observación nueva, encuentra las K observaciones más cercanas en los datos de entrenamiento (ignorando la respuesta).</p></li>
<li><p>Para la observación nueva, el algoritmo predice el valor de la respuesta mas común entre las K observaciones más cercanas.</p></li>
</ol>
</section>
<section id="section-24" class="slide level2">
<h2></h2>
<p>Supongamos que tenemos dos grupos: el grupo rojo y el grupo verde. La recta numérica muestra el valor de una variable para nuestros datos de entrenamiento.</p>
<p>Llega una nueva observación y no sabemos a qué grupo pertenece.</p>

<img data-src="images/ball_example.png" class="quarto-figure quarto-figure-center r-stretch"><p>Si hubiéramos elegido K=3, entonces los tres vecinos más cercanos votarían a qué grupo pertenece la nueva observación.</p>
</section>
<section id="section-25" class="slide level2">
<h2></h2>
<p>Usando <span class="math inline">\(K = 3\)</span>, son 2 votos para “genuino” y 2 para “falso”. Entonces clasificamos como “geniunio”.</p>

<img data-src="images/ball_example2.png" class="quarto-figure quarto-figure-center r-stretch"><p>La cercanía se basa en la distancia Euclidiana.</p>
</section>
<section id="detalles-de-implementación-1" class="slide level2">
<h2>Detalles de implementación</h2>
<p><strong>Empates</strong></p>
<ul>
<li><p>Si hay más de <em>K</em> vecinos mas cercanos, incluyelos todos.</p></li>
<li><p>Si hay un empate en la votación, fija una regla para romper el empate. Por ejemplo, seleccionar la clase aleatoriamente.</p></li>
</ul>
</section>
<section id="section-26" class="slide level2">
<h2></h2>
<p><strong><em>KNN utiliza la distancia euclidiana entre puntos</em></strong>. Entonces ignora las unidades.</p>
<ul>
<li><p>Ejemplo: dos predictores: altura en cm y extensión de brazos en pies. Compare dos personas: (152.4, 1.52) y (182.88, 1.85).</p></li>
<li><p>Estas personas están separadas por 30.48 unidades de distancia en la primera variable, pero sólo por 0.33 unidades en la segunda.</p></li>
<li><p>Por lo tanto, el primer predictor juega un papel mucho más importante en la clasificación y puede impulsar los resultados de modo que la segunda variable se vuelva inútil.</p></li>
</ul>
</section>
<section id="section-27" class="slide level2">
<h2></h2>
<p>Como primer paso, ¡debemos de transformar los predictores para que tengan las mismas unidades!</p>
<p>Esto requiere un proceso de estandarización de los predictores, que se hace en Python.</p>
</section>
<section id="estandarización" class="slide level2">
<h2>Estandarización</h2>
<p><br></p>
<p>La estandarización se refiere a <em>centrar</em> y <em>escalar</em> cada predictor numérico individualmente. Esto coloca a todos los predictores en la misma escala.</p>
<p>Para <strong>centrar</strong> una variable predictora, se resta el valor promedio del predictor de todos los valores.</p>
<p>Por lo tanto, el predictor centrado tiene una media cero (es decir, su valor promedio es cero).</p>
</section>
<section id="section-28" class="slide level2">
<h2></h2>
<p><br></p>
<p>Para <strong>escalar</strong> un predictor, cada uno de sus valores se divide entre su desviación estándar.</p>
<p>Al escalar los datos, los valores tienen una desviación estándar común de uno.</p>
<p>En términos matemáticos, estandarizamos un predictor como:</p>
<p><span class="math display">\[{\color{blue} \tilde{X}_{i}} = \frac{{ X_{i} - \bar{X}}}{ \sqrt{\frac{1}{n -1} \sum_{i=1}^{n} (X_{i} - \bar{X})^2}},\]</span></p>
<p>con <span class="math inline">\(\bar{X} = \sum_{i=1}^n \frac{x_i}{n}\)</span>.</p>
</section>
<section id="ejemplo-1-cont." class="slide level2">
<h2>Ejemplo 1 (cont.)</h2>
<p>Usamos los cinco predictores numéricos del conjunto de datos <code>complete_sbAuto</code>.</p>
<div id="45f162f7" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a><span class="co">#complete_sbAuto.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dos-predictores-en-unidades-originales" class="slide level2">
<h2>Dos predictores en unidades originales</h2>
<p>Considere el conjunto de datos <code>complete_sbAuto</code> creado previamente. Considere dos puntos en el gráfico: <span class="math inline">\((175, 5140)\)</span> y <span class="math inline">\((69, 1613)\)</span>.</p>
<div class="columns">
<div class="column" style="width:50%;">

</div><div class="column" style="width:50%;">
<p><br></p>
<p>La distancia entre estos puntos es <span class="math inline">\(\sqrt{(69 - 175)^2 + (1613-5140)^2}\)</span> <span class="math inline">\(= \sqrt{11236 + 12439729}\)</span> <span class="math inline">\(= 3528.592\)</span>.</p>
</div></div>
</section>
<section id="estandarización-en-python" class="slide level2">
<h2>Estandarización en Python</h2>
<p><br></p>
<p>Para estandarizar predictores <strong>numéricos</strong>, usamos la función <code>StandardScaler()</code>. Además, aplicamos la función a las variables mediante la función <code>fit_transform()</code>.</p>
<p><br></p>
<div id="4460bef2" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a><span class="co">#scaler = StandardScaler()</span></span>
<span id="cb12-2"><a></a><span class="co">#Xs = scaler.fit_transform(complete_sbAuto)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-29" class="slide level2">
<h2></h2>
<p>Lamentablemente, el objeto resultante no es un marco de datos de Pandas. Por lo tanto, lo convertimos a este formato.</p>
<div id="b7efde08" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a><span class="co">#scaled_df = pd.DataFrame(Xs, columns = complete_sbAuto.columns)</span></span>
<span id="cb13-2"><a></a><span class="co">#scaled_df.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dos-predictores-en-unidades-estandarizadas" class="slide level2">
<h2>Dos predictores en unidades estandarizadas</h2>
<p>En la nueva escala, los dos puntos ahora son: <span class="math inline">\((1.82, 2.53)\)</span> y <span class="math inline">\((-0.91, -1.60)\)</span>.</p>
<div class="columns">
<div class="column" style="width:50%;">

</div><div class="column" style="width:50%;">
<p><br></p>
<p>La distancia entre estos puntos es <span class="math inline">\(\sqrt{(-0.91 - 1.82)^2 + (-1.60-2.53)^2}\)</span> <span class="math inline">\(= \sqrt{7.45 + 17.05} = 4.95\)</span>.</p>
</div></div>
</section>
<section id="discusión-1" class="slide level2">
<h2>Discusión</h2>
<p>K-NN es intuitivo y sencillo y puede producir predicciones decentes. Sin embargo, K-NN tiene algunas desventajas:</p>
<ul>
<li><p>Cuando el conjunto de datos de entrenamiento es muy grande, K-NN es computacionalmente costoso. Esto se debe a que, para predecir una observación, necesitamos calcular la distancia entre la observación y todas las demás en el conjunto de datos. (“Aprendiz perezoso”).</p></li>
<li><p>En este caso, un arbol de decisión es mas ventajoso porque es fácil de construir, almacenar, y hacer predicciones con él.</p></li>
</ul>
</section>
<section id="section-30" class="slide level2">
<h2></h2>
<ul>
<li><p>El rendimiento predictivo de K-NN se deteriora a medida que aumenta el número de predictores.</p></li>
<li><p>Esto se debe a que la distancia esperada al vecino más cercano aumenta drásticamente con el número de predictores, a menos que el tamaño del conjunto de datos aumente exponencialmente con este número.</p></li>
<li><p>Esto se conoce como la <strong><em>maldición de la dimensionalidad</em></strong>.</p></li>
</ul>

<img data-src="images/clipboard-72810347.png" class="r-stretch"><p><a href="https://aiaspirant.com/curse-of-dimensionality/" class="uri">https://aiaspirant.com/curse-of-dimensionality/</a></p>
</section></section>
<section id="return-to-main-page" class="title-slide slide level1 center">
<h1><a href="https://alanrvazquez.github.io/TEC-IN1002B-Website/">Return to main page</a></h1>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="IN1002b_logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Tecnologico de Monterrey</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>